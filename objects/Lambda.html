<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Bedrock Code</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism.min.css">
  <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-hcl.min.js"></script>
  <style>
    body { font-family: system-ui, sans-serif; padding: 20px; background:#0f172a; color:#e5e7eb; }
    pre { border-radius: 12px; padding: 16px; }
    a { color: #93c5fd; }
  </style>
</head>
<body>
  <h1>Bedrock Example</h1>
  <a href="../index.html">‚Üê Back to Diagram</a>

  <pre><code class="language-hcl">
# Action Group - API Schema for Bedrock in json
{
  "openapi": "3.0.1",
  "info": {
    "title": "Microsoft Graph Tools",
    "version": "1.0.0",
    "description": "Action Group exposing common Microsoft Graph operations via a single Lambda. Supports commercial (graph.microsoft.com) and GCC High/DoD (graph.microsoft.us). Default is application permissions; optionally pass userAccessToken for delegated/OBO flows."
  },
  "servers": [
    {
      "url": "https://graph.microsoft.com",
      "description": "Commercial Graph"
    },
    {
      "url": "https://graph.microsoft.us",
      "description": "US Gov / GCC High / DoD"
    }
  ],
  "paths": {
    "/users/{userPrincipalName}": {
      "get": {
        "summary": "Get user profile",
        "description": "Retrieve basic user details by UPN.",
        "x-amazon-bedrock-integration": { "lambdaName": "graph-tools-lambda" },
        "parameters": [
          { "name": "userPrincipalName", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "select", "in": "query", "required": false, "schema": { "type": "string" }, "description": "Comma-separated fields (e.g., displayName,mail,jobTitle)" },
          { "name": "userAccessToken", "in": "header", "required": false, "schema": { "type": "string" }, "description": "Optional delegated token for OBO." }
        ],
        "responses": {
          "200": { "description": "User", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/User" } } } }
        }
      }
    },

    "/users/{userPrincipalName}/presence": {
      "get": {
        "summary": "Get user presence",
        "description": "Return presence (Available/Busy/etc.) for a user.",
        "x-amazon-bedrock-integration": { "lambdaName": "graph-tools-lambda" },
        "parameters": [
          { "name": "userPrincipalName", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "userAccessToken", "in": "header", "required": false, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": { "description": "Presence", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Presence" } } } }
        }
      }
    },

    "/users/{userPrincipalName}/calendar/events": {
      "get": {
        "summary": "List calendar events",
        "description": "List upcoming events for a user in start-time order.",
        "x-amazon-bedrock-integration": { "lambdaName": "graph-tools-lambda" },
        "parameters": [
          { "name": "userPrincipalName", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "top", "in": "query", "required": false, "schema": { "type": "integer", "default": 5, "minimum": 1, "maximum": 50 } },
          { "name": "startDateTime", "in": "query", "required": false, "schema": { "type": "string", "format": "date-time" }, "description": "ISO 8601" },
          { "name": "endDateTime", "in": "query", "required": false, "schema": { "type": "string", "format": "date-time" }, "description": "ISO 8601" },
          { "name": "userAccessToken", "in": "header", "required": false, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": { "description": "Events", "content": { "application/json": { "schema": { "type": "object", "properties": { "events": { "type": "array", "items": { "$ref": "#/components/schemas/Event" } } } } } } }
        }
      }
    },

    "/users/{userPrincipalName}/sendMail": {
      "post": {
        "summary": "Send an email",
        "description": "Send mail from a service mailbox or delegated user.",
        "x-amazon-bedrock-integration": { "lambdaName": "graph-tools-lambda" },
        "parameters": [
          { "name": "userPrincipalName", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "userAccessToken", "in": "header", "required": false, "schema": { "type": "string" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["to", "subject", "bodyText"],
                "properties": {
                  "to": { "type": "array", "items": { "type": "string", "format": "email" }, "minItems": 1 },
                  "cc": { "type": "array", "items": { "type": "string", "format": "email" } },
                  "subject": { "type": "string", "maxLength": 250 },
                  "bodyText": { "type": "string" }
                }
              }
            }
          }
        },
        "responses": { "202": { "description": "Accepted" } }
      }
    },

    "/teams/{teamId}/channels": {
      "get": {
        "summary": "List channels in a team",
        "x-amazon-bedrock-integration": { "lambdaName": "graph-tools-lambda" },
        "parameters": [
          { "name": "teamId", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "top", "in": "query", "required": false, "schema": { "type": "integer", "default": 20, "minimum": 1, "maximum": 50 } },
          { "name": "userAccessToken", "in": "header", "required": false, "schema": { "type": "string" } }
        ],
        "responses": { "200": { "description": "Channels", "content": { "application/json": { "schema": { "type": "object", "properties": { "channels": { "type": "array", "items": { "$ref": "#/components/schemas/Channel" } } } } } } } }
      }
    },

    "/teams/{teamId}/channels/{channelId}/messages": {
      "get": {
        "summary": "List channel messages",
        "x-amazon-bedrock-integration": { "lambdaName": "graph-tools-lambda" },
        "parameters": [
          { "name": "teamId", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "channelId", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "top", "in": "query", "required": false, "schema": { "type": "integer", "default": 20, "minimum": 1, "maximum": 50 } },
          { "name": "userAccessToken", "in": "header", "required": false, "schema": { "type": "string" } }
        ],
        "responses": { "200": { "description": "Messages", "content": { "application/json": { "schema": { "type": "object", "properties": { "messages": { "type": "array", "items": { "$ref": "#/components/schemas/Message" } } } } } } } }
      },
      "post": {
        "summary": "Post a channel message",
        "description": "Post a simple text message to a channel.",
        "x-amazon-bedrock-integration": { "lambdaName": "graph-tools-lambda" },
        "parameters": [
          { "name": "teamId", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "channelId", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "userAccessToken", "in": "header", "required": false, "schema": { "type": "string" } }
        ],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "type": "object", "required": ["text"], "properties": { "text": { "type": "string", "maxLength": 25000 } } } } }
        },
        "responses": { "201": { "description": "Message created", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Message" } } } } }
      }
    },

    "/chats/{chatId}/messages": {
      "post": {
        "summary": "Post a 1:1 or group chat message",
        "x-amazon-bedrock-integration": { "lambdaName": "graph-tools-lambda" },
        "parameters": [
          { "name": "chatId", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "userAccessToken", "in": "header", "required": false, "schema": { "type": "string" } }
        ],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "type": "object", "required": ["text"], "properties": { "text": { "type": "string", "maxLength": 25000 } } } } }
        },
        "responses": { "201": { "description": "Message created", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Message" } } } } }
      }
    },

    "/users/{userPrincipalName}/drive/root/children": {
      "get": {
        "summary": "List files in OneDrive/SharePoint root",
        "description": "Lists top-level items; use filters/select for performance.",
        "x-amazon-bedrock-integration": { "lambdaName": "graph-tools-lambda" },
        "parameters": [
          { "name": "userPrincipalName", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "top", "in": "query", "required": false, "schema": { "type": "integer", "default": 20, "minimum": 1, "maximum": 200 } },
          { "name": "select", "in": "query", "required": false, "schema": { "type": "string" }, "description": "Fields (e.g., id,name,webUrl,size,lastModifiedDateTime)" },
          { "name": "filter", "in": "query", "required": false, "schema": { "type": "string" }, "description": "OData filter" },
          { "name": "userAccessToken", "in": "header", "required": false, "schema": { "type": "string" } }
        ],
        "responses": { "200": { "description": "Drive items", "content": { "application/json": { "schema": { "type": "object", "properties": { "items": { "type": "array", "items": { "$ref": "#/components/schemas/FileItem" } } } } } } } }
      }
    }
  },

  "components": {
    "schemas": {
      "User": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "displayName": { "type": "string" },
          "mail": { "type": "string" },
          "userPrincipalName": { "type": "string" },
          "jobTitle": { "type": "string" },
          "department": { "type": "string" }
        }
      },
      "Presence": {
        "type": "object",
        "properties": {
          "availability": { "type": "string", "example": "Available" },
          "activity": { "type": "string", "example": "InAMeeting" }
        }
      },
      "Event": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "subject": { "type": "string" },
          "start": { "type": "string", "description": "ISO 8601" },
          "end": { "type": "string", "description": "ISO 8601" },
          "location": { "type": "string" },
          "organizer": { "type": "string" },
          "webLink": { "type": "string" }
        }
      },
      "Channel": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "displayName": { "type": "string" },
          "membershipType": { "type": "string" }
        }
      },
      "Message": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "from": { "type": "string" },
          "createdDateTime": { "type": "string" },
          "bodyPreview": { "type": "string" },
          "webUrl": { "type": "string" },
          "text": { "type": "string", "description": "Only on POST request echo" }
        }
      },
      "FileItem": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "name": { "type": "string" },
          "size": { "type": "integer" },
          "lastModifiedDateTime": { "type": "string" },
          "webUrl": { "type": "string" },
          "folder": { "type": "boolean", "description": "True if the item is a folder" }
        }
      }
    }
  }
}

}
  </code></pre>
</body>
</html>
